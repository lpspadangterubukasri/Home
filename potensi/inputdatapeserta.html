<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendataan Peserta LPS - Semua Kategori</title>
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lpspadangterubukasri.github.io/Home/pendataan">
    <meta property="og:title" content="Pendataan Peserta LPS - Rumah Tangga, UMKM, Badan Usaha">
    <meta property="og:description" content="Formulir pendataan peserta Lembaga Pengelola Sampah (LPS) Kelurahan Padang Terubuk">
    <meta property="og:site_name" content="LPS PADANG TERUBUK">
    <meta property="og:image" content="https://lpspadangterubukasri.github.io/Home/data/foto/thumbnail.png">
    <meta property="og:image:secure_url" content="https://lpspadangterubukasri.github.io/Home/data/foto/thumbnail.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://lpspadangterubukasri.github.io/Home/data/foto/favicon.png">
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #f0f9f0 0%, #e8f5e9 50%, #c8e6c9 100%);
            background-attachment: fixed;
            padding: 2rem 1rem;
            position: relative;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 32px;
            box-shadow: 0 20px 40px rgba(0, 50, 0, 0.1), 0 8px 20px rgba(0, 80, 0, 0.06);
        }

        .glass-header {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(76, 175, 80, 0.2);
            border-radius: 60px;
            box-shadow: 0 10px 30px rgba(46, 125, 50, 0.15);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            position: sticky;
            top: 1rem;
            z-index: 10;
        }

        .logo-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 48px;
            height: 48px;
            border-radius: 16px;
            background: white;
            padding: 4px;
            box-shadow: 0 4px 10px rgba(0, 80, 0, 0.1);
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .title h1 {
            font-size: 1.35rem;
            font-weight: 700;
            color: #1b5e20;
            letter-spacing: -0.01em;
            line-height: 1.3;
        }

        .title p {
            font-size: 0.8rem;
            color: #2e7d32;
            opacity: 0.8;
            font-weight: 500;
        }

        .back-button {
            width: 48px;
            height: 48px;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(76, 175, 80, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #2e7d32;
            font-size: 1.3rem;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .back-button:hover {
            background: white;
            border-color: #2e7d32;
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(46, 125, 50, 0.2);
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            padding: 0.5rem;
            border-radius: 60px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tab-btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            background: transparent;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* Warna tab berdasarkan tema */
        .tab-btn:nth-child(1) {
            color: #2e7d32;
        }
        .tab-btn:nth-child(2) {
            color: #1976d2;
        }
        .tab-btn:nth-child(3) {
            color: #7b1fa2;
        }

        .tab-btn.active:nth-child(1) {
            background: white;
            color: #1b5e20;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.2);
        }
        .tab-btn.active:nth-child(2) {
            background: white;
            color: #0d47a1;
            box-shadow: 0 4px 15px rgba(25, 118, 210, 0.2);
        }
        .tab-btn.active:nth-child(3) {
            background: white;
            color: #4a148c;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.2);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Form Card dengan tema warna */
        .form-card {
            padding: 2rem 2rem 2.5rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        /* Tema Hijau untuk Rumah Tangga */
        #rumah-tangga .form-card {
            background: rgba(232, 245, 233, 0.75);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        #rumah-tangga .form-header i {
            color: #2e7d32;
            background: rgba(46, 125, 50, 0.15);
        }
        #rumah-tangga .form-header h2,
        #rumah-tangga .form-header p {
            color: #1b5e20;
        }
        #rumah-tangga .input-group label {
            color: #1b5e20;
        }
        #rumah-tangga .input-group label i {
            color: #2e7d32;
        }
        #rumah-tangga .input-wrapper i {
            color: #66bb6a;
        }
        #rumah-tangga .input-wrapper input:focus,
        #rumah-tangga .input-wrapper select:focus,
        #rumah-tangga .input-wrapper textarea:focus {
            border-color: #2e7d32;
            box-shadow: 0 0 0 4px rgba(46, 125, 50, 0.1);
        }

        /* Tema Biru untuk UMKM */
        #umkm .form-card {
            background: rgba(227, 242, 253, 0.75);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(33, 150, 243, 0.3);
        }
        #umkm .form-header i {
            color: #1976d2;
            background: rgba(25, 118, 210, 0.15);
        }
        #umkm .form-header h2,
        #umkm .form-header p {
            color: #0d47a1;
        }
        #umkm .input-group label {
            color: #0d47a1;
        }
        #umkm .input-group label i {
            color: #1976d2;
        }
        #umkm .input-wrapper i {
            color: #42a5f5;
        }
        #umkm .input-wrapper input:focus,
        #umkm .input-wrapper select:focus,
        #umkm .input-wrapper textarea:focus {
            border-color: #1976d2;
            box-shadow: 0 0 0 4px rgba(25, 118, 210, 0.1);
        }

        /* Tema Ungu untuk Badan Usaha */
        #badan-usaha .form-card {
            background: rgba(243, 229, 245, 0.75);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(156, 39, 176, 0.3);
        }
        #badan-usaha .form-header i {
            color: #7b1fa2;
            background: rgba(123, 31, 162, 0.15);
        }
        #badan-usaha .form-header h2,
        #badan-usaha .form-header p {
            color: #4a148c;
        }
        #badan-usaha .input-group label {
            color: #4a148c;
        }
        #badan-usaha .input-group label i {
            color: #7b1fa2;
        }
        #badan-usaha .input-wrapper i {
            color: #ab47bc;
        }
        #badan-usaha .input-wrapper input:focus,
        #badan-usaha .input-wrapper select:focus,
        #badan-usaha .input-wrapper textarea:focus {
            border-color: #7b1fa2;
            box-shadow: 0 0 0 4px rgba(123, 31, 162, 0.1);
        }

        .form-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .form-header i {
            font-size: 2rem;
            padding: 0.75rem;
            border-radius: 18px;
        }

        .form-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .form-header p {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .full-width {
            grid-column: span 2;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .input-group label {
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.3px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-group label i {
            font-size: 0.9rem;
            width: 18px;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-wrapper i {
            position: absolute;
            left: 16px;
            font-size: 0.95rem;
        }

        .input-wrapper input,
        .input-wrapper select,
        .input-wrapper textarea {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 2.8rem;
            border: 1.5px solid;
            border-radius: 20px;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(4px);
            transition: all 0.2s;
            color: #1e3a2a;
            font-weight: 500;
        }

        /* Warna border untuk setiap tema */
        #rumah-tangga .input-wrapper input,
        #rumah-tangga .input-wrapper select,
        #rumah-tangga .input-wrapper textarea {
            border-color: rgba(76, 175, 80, 0.2);
        }
        #umkm .input-wrapper input,
        #umkm .input-wrapper select,
        #umkm .input-wrapper textarea {
            border-color: rgba(33, 150, 243, 0.2);
        }
        #badan-usaha .input-wrapper input,
        #badan-usaha .input-wrapper select,
        #badan-usaha .input-wrapper textarea {
            border-color: rgba(156, 39, 176, 0.2);
        }

        .input-wrapper input::placeholder {
            color: #a5d6a7;
            font-weight: 400;
        }

        input[type="date"] {
            color: #1e3a2a;
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0.6;
            cursor: pointer;
        }
        
        /* Warna date picker icon per tema */
        #rumah-tangga input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.5) sepia(1) hue-rotate(90deg);
        }
        #umkm input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.5) sepia(1) hue-rotate(180deg);
        }
        #badan-usaha input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.5) sepia(1) hue-rotate(250deg);
        }

        .input-wrapper textarea {
            min-height: 80px;
            resize: vertical;
            padding-top: 0.9rem;
        }

        select {
            appearance: none;
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 16px;
        }

        .submit-section {
            margin-top: 2.5rem;
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .btn-submit {
            background: linear-gradient(145deg, #2e7d32, #1b5e20);
            color: white;
            border: none;
            padding: 1rem 3.5rem;
            border-radius: 40px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(27, 94, 32, 0.3);
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-submit i {
            font-size: 1.2rem;
        }

        .btn-submit:hover {
            background: linear-gradient(145deg, #1b5e20, #0d4d13);
            transform: translateY(-3px);
            box-shadow: 0 15px 25px rgba(27, 94, 32, 0.4);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 30, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 40px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 30px 50px rgba(0, 50, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(145deg, #2e7d32, #1b5e20);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: white;
            font-size: 2.5rem;
            box-shadow: 0 15px 25px rgba(46, 125, 50, 0.3);
        }

        .modal-content h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1b5e20;
            margin-bottom: 0.75rem;
        }

        .modal-content p {
            color: #2e7d32;
            margin-bottom: 2rem;
            font-size: 1rem;
            font-weight: 500;
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .modal-btn {
            padding: 0.9rem 2rem;
            border-radius: 40px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            flex: 1;
        }

        .btn-primary {
            background: #2e7d32;
            color: white;
            box-shadow: 0 8px 15px rgba(46, 125, 50, 0.2);
        }

        .btn-primary:hover {
            background: #1b5e20;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid #2e7d32;
            color: #2e7d32;
        }

        .btn-secondary:hover {
            background: rgba(46, 125, 50, 0.05);
            transform: translateY(-2px);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #c8e6c9;
            border-top-color: #2e7d32;
            border-radius: 50%;
            animation: spin 1s infinite linear;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            color: #2e7d32;
            font-size: 0.8rem;
            font-weight: 500;
            opacity: 0.7;
            margin-top: 2rem;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-left: 4px solid #2e7d32;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 3000;
            display: none;
            align-items: center;
            gap: 12px;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            display: flex;
        }

        .notification i {
            color: #2e7d32;
            font-size: 1.2rem;
        }

        @media (max-width: 700px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .full-width {
                grid-column: span 1;
            }
            .form-card {
                padding: 1.5rem;
            }
            .tab-navigation {
                flex-direction: column;
                border-radius: 30px;
            }
            .tab-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header dengan Logo dan Tombol Kembali -->
        <div class="header glass-header">
            <div class="logo-title">
                <div class="logo">
                    <img src="https://lpspadangterubukasri.github.io/Home/data/foto/favicon.png" alt="Logo LPS">
                </div>
                <div class="title">
                    <h1>PENDATAAN PESERTA LPS</h1>
                    <p>RUMAH TANGGA • UMKM • BADAN USAHA</p>
                </div>
            </div>
            <a href="https://lpspadangterubukasri.github.io/Home" class="back-button">
                <i class="fas fa-arrow-left"></i>
            </a>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation glass-card">
            <button class="tab-btn active" onclick="switchTab('rumah-tangga')">
                <i class="fas fa-home"></i> RUMAH TANGGA
            </button>
            <button class="tab-btn" onclick="switchTab('umkm')">
                <i class="fas fa-store"></i> UMKM
            </button>
            <button class="tab-btn" onclick="switchTab('badan-usaha')">
                <i class="fas fa-building"></i> BADAN USAHA
            </button>
        </div>

        <!-- TAB 1: RUMAH TANGGA (Hijau) -->
        <div id="rumah-tangga" class="tab-content active">
            <div class="form-card">
                <div class="form-header">
                    <i class="fas fa-home"></i>
                    <div>
                        <h2>Formulir Pendataan Rumah Tangga</h2>
                        <p>Mohon Isi Data Dengan Teliti</p>
                    </div>
                </div>

                <div class="form-grid">
                    <!-- TANGGAL_INPUT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-calendar-alt"></i> TANGGAL INPUT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-calendar-check"></i>
                            <input type="date" id="rt_tanggal" class="tanggal-input">
                        </div>
                    </div>

                    <!-- NAMA_PESERTA -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-user"></i> NAMA PESERTA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-user-pen"></i>
                            <input type="text" id="rt_nama" class="uppercase-input" placeholder="NAMA LENGKAP">
                        </div>
                    </div>

                    <!-- NO_NIK & NO_KK -->
                    <div class="input-group">
                        <label><i class="fas fa-id-card"></i> NO. NIK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="rt_nik" class="nik-input" placeholder="16 DIGIT NIK" maxlength="16">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-id-card-clip"></i> NO. KK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card-clip"></i>
                            <input type="text" id="rt_kk" class="kk-input" placeholder="16 DIGIT NO KK" maxlength="16">
                        </div>
                    </div>

                    <!-- ALAMAT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-map-pin"></i> ALAMAT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map-location-dot"></i>
                            <textarea id="rt_alamat" class="uppercase-input" placeholder="ALAMAT DAN NO RUMAH"></textarea>
                        </div>
                    </div>

                    <!-- RT & RW -->
                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="rt_rt" class="uppercase-input rt-input" placeholder="CONTOH: 001" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RW</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="rt_rw" class="uppercase-input rw-input" placeholder="CONTOH: 002" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <!-- KELURAHAN, KECAMATAN, KOTA, PROVINSI -->
                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KELURAHAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="rt_kelurahan" class="uppercase-input" value="PADANG TERUBUK">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KECAMATAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="rt_kecamatan" class="uppercase-input" value="SENAPELAN">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-city"></i> KOTA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-city"></i>
                            <input type="text" id="rt_kota" class="uppercase-input" value="PEKANBARU">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-flag"></i> PROVINSI</label>
                        <div class="input-wrapper">
                            <i class="fas fa-flag"></i>
                            <input type="text" id="rt_provinsi" class="uppercase-input" value="RIAU">
                        </div>
                    </div>

                    <!-- NO_TELP -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-phone-alt"></i> NO. TELP / HP</label>
                        <div class="input-wrapper">
                            <i class="fas fa-phone-alt"></i>
                            <input type="tel" id="rt_telp" class="telp-input" placeholder="08XXXXXXXXXX" maxlength="15">
                        </div>
                    </div>

                    <!-- STATUS -->
                    <div class="input-group">
                        <label><i class="fas fa-toggle-on"></i> STATUS</label>
                        <div class="input-wrapper">
                            <i class="fas fa-check-circle"></i>
                            <select id="rt_status">
                                <option value="" selected disabled>-- PILIH STATUS --</option>
                                <option value="PESERTA LPS">PESERTA LPS</option>
                                <option value="PESERTA SUBSIDI SILANG">PESERTA SUBSIDI SILANG</option>
                                <option value="TIDAK IKUT LPS">TIDAK IKUT LPS</option>
                            </select>
                        </div>
                    </div>

                    <!-- TARIF IURAN -->
                    <div class="input-group">
                        <label><i class="fas fa-money-bill-wave"></i> TARIF IURAN (Rp)</label>
                        <div class="input-wrapper">
                            <i class="fas fa-hand-holding-usd"></i>
                            <input type="number" id="rt_tarif" placeholder="CONTOH: 50000" min="0" step="1000">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: UMKM (Biru) -->
        <div id="umkm" class="tab-content">
            <div class="form-card">
                <div class="form-header">
                    <i class="fas fa-store"></i>
                    <div>
                        <h2>Formulir Pendataan UMKM</h2>
                        <p>Mohon Isi Data Dengan Teliti</p>
                    </div>
                </div>

                <div class="form-grid">
                    <!-- TANGGAL_INPUT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-calendar-alt"></i> TANGGAL INPUT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-calendar-check"></i>
                            <input type="date" id="umkm_tanggal" class="tanggal-input">
                        </div>
                    </div>

                    <!-- NAMA_PESERTA -->
                    <div class="input-group">
                        <label><i class="fas fa-user"></i> NAMA PEMILIK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-user-pen"></i>
                            <input type="text" id="umkm_nama" class="uppercase-input" placeholder="NAMA LENGKAP PEMILIK">
                        </div>
                    </div>

                    <!-- NAMA_UMKM -->
                    <div class="input-group">
                        <label><i class="fas fa-store-alt"></i> NAMA UMKM</label>
                        <div class="input-wrapper">
                            <i class="fas fa-store-alt"></i>
                            <input type="text" id="umkm_nama_usaha" class="uppercase-input" placeholder="NAMA USAHA">
                        </div>
                    </div>

                    <!-- NO_SURAT_IZIN_USAHA_UMKM -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-file-contract"></i> NO. SURAT IZIN USAHA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-file-contract"></i>
                            <input type="text" id="umkm_no_izin" class="uppercase-input" placeholder="NOMOR IZIN USAHA">
                        </div>
                    </div>

                    <!-- NO_NIK & NO_KK -->
                    <div class="input-group">
                        <label><i class="fas fa-id-card"></i> NO. NIK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="umkm_nik" class="nik-input" placeholder="16 DIGIT NIK" maxlength="16">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-id-card-clip"></i> NO. KK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card-clip"></i>
                            <input type="text" id="umkm_kk" class="kk-input" placeholder="16 DIGIT NO KK" maxlength="16">
                        </div>
                    </div>

                    <!-- ALAMAT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-map-pin"></i> ALAMAT USAHA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map-location-dot"></i>
                            <textarea id="umkm_alamat" class="uppercase-input" placeholder="ALAMAT LENGKAP USAHA"></textarea>
                        </div>
                    </div>

                    <!-- RT & RW -->
                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="umkm_rt" class="uppercase-input rt-input" placeholder="CONTOH: 001" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RW</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="umkm_rw" class="uppercase-input rw-input" placeholder="CONTOH: 002" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <!-- KELURAHAN, KECAMATAN, KOTA, PROVINSI -->
                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KELURAHAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="umkm_kelurahan" class="uppercase-input" value="PADANG TERUBUK">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KECAMATAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="umkm_kecamatan" class="uppercase-input" value="SENAPELAN">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-city"></i> KOTA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-city"></i>
                            <input type="text" id="umkm_kota" class="uppercase-input" value="PEKANBARU">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-flag"></i> PROVINSI</label>
                        <div class="input-wrapper">
                            <i class="fas fa-flag"></i>
                            <input type="text" id="umkm_provinsi" class="uppercase-input" value="RIAU">
                        </div>
                    </div>

                    <!-- NO_TELP -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-phone-alt"></i> NO. TELP / HP</label>
                        <div class="input-wrapper">
                            <i class="fas fa-phone-alt"></i>
                            <input type="tel" id="umkm_telp" class="telp-input" placeholder="08XXXXXXXXXX" maxlength="15">
                        </div>
                    </div>

                    <!-- STATUS -->
                    <div class="input-group">
                        <label><i class="fas fa-toggle-on"></i> STATUS</label>
                        <div class="input-wrapper">
                            <i class="fas fa-check-circle"></i>
                            <select id="umkm_status">
                                <option value="" selected disabled>-- PILIH STATUS --</option>
                                <option value="PESERTA LPS">PESERTA LPS</option>
                                <option value="PESERTA DLHK">PESERTA DLHK</option>
                                <option value="TIDAK IKUT LPS">TIDAK IKUT LPS</option>
                            </select>
                        </div>
                    </div>

                    <!-- TARIF IURAN -->
                    <div class="input-group">
                        <label><i class="fas fa-money-bill-wave"></i> TARIF IURAN (Rp)</label>
                        <div class="input-wrapper">
                            <i class="fas fa-hand-holding-usd"></i>
                            <input type="number" id="umkm_tarif" placeholder="CONTOH: 50000" min="0" step="1000">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: BADAN USAHA (Ungu) -->
        <div id="badan-usaha" class="tab-content">
            <div class="form-card">
                <div class="form-header">
                    <i class="fas fa-building"></i>
                    <div>
                        <h2>Formulir Pendataan Badan Usaha</h2>
                        <p>Mohon Isi Data Dengan Teliti</p>
                    </div>
                </div>

                <div class="form-grid">
                    <!-- TANGGAL_INPUT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-calendar-alt"></i> TANGGAL INPUT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-calendar-check"></i>
                            <input type="date" id="bu_tanggal" class="tanggal-input">
                        </div>
                    </div>

                    <!-- NAMA_PESERTA -->
                    <div class="input-group">
                        <label><i class="fas fa-user"></i> NAMA PENANGGUNG JAWAB</label>
                        <div class="input-wrapper">
                            <i class="fas fa-user-pen"></i>
                            <input type="text" id="bu_nama" class="uppercase-input" placeholder="NAMA LENGKAP">
                        </div>
                    </div>

                    <!-- NAMA_BADAN_USAHA -->
                    <div class="input-group">
                        <label><i class="fas fa-building"></i> NAMA BADAN USAHA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-building"></i>
                            <input type="text" id="bu_nama_usaha" class="uppercase-input" placeholder="NAMA PERUSAHAAN">
                        </div>
                    </div>

                    <!-- NO_SURAT_IZIN_BADAN_USAHA -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-file-contract"></i> NO. SURAT IZIN USAHA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-file-contract"></i>
                            <input type="text" id="bu_no_izin" class="uppercase-input" placeholder="NIB / SIUP / IZIN LAINNYA">
                        </div>
                    </div>

                    <!-- NO_NIK & NO_KK -->
                    <div class="input-group">
                        <label><i class="fas fa-id-card"></i> NO. NIK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="bu_nik" class="nik-input" placeholder="16 DIGIT NIK" maxlength="16">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-id-card-clip"></i> NO. KK</label>
                        <div class="input-wrapper">
                            <i class="fas fa-id-card-clip"></i>
                            <input type="text" id="bu_kk" class="kk-input" placeholder="16 DIGIT NO KK" maxlength="16">
                        </div>
                    </div>

                    <!-- ALAMAT -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-map-pin"></i> ALAMAT USAHA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map-location-dot"></i>
                            <textarea id="bu_alamat" class="uppercase-input" placeholder="ALAMAT LENGKAP USAHA"></textarea>
                        </div>
                    </div>

                    <!-- RT & RW -->
                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RT</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="bu_rt" class="uppercase-input rt-input" placeholder="CONTOH: 001" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-road"></i> RW</label>
                        <div class="input-wrapper">
                            <i class="fas fa-route"></i>
                            <input type="text" id="bu_rw" class="uppercase-input rw-input" placeholder="CONTOH: 002" maxlength="3" oninput="formatRT_RW(this)">
                        </div>
                    </div>

                    <!-- KELURAHAN, KECAMATAN, KOTA, PROVINSI -->
                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KELURAHAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="bu_kelurahan" class="uppercase-input" value="PADANG TERUBUK">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-map"></i> KECAMATAN</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map"></i>
                            <input type="text" id="bu_kecamatan" class="uppercase-input" value="SENAPELAN">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-city"></i> KOTA</label>
                        <div class="input-wrapper">
                            <i class="fas fa-city"></i>
                            <input type="text" id="bu_kota" class="uppercase-input" value="PEKANBARU">
                        </div>
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-flag"></i> PROVINSI</label>
                        <div class="input-wrapper">
                            <i class="fas fa-flag"></i>
                            <input type="text" id="bu_provinsi" class="uppercase-input" value="RIAU">
                        </div>
                    </div>

                    <!-- NO_TELP -->
                    <div class="input-group full-width">
                        <label><i class="fas fa-phone-alt"></i> NO. TELP / HP</label>
                        <div class="input-wrapper">
                            <i class="fas fa-phone-alt"></i>
                            <input type="tel" id="bu_telp" class="telp-input" placeholder="08XXXXXXXXXX" maxlength="15">
                        </div>
                    </div>

                    <!-- STATUS -->
                    <div class="input-group">
                        <label><i class="fas fa-toggle-on"></i> STATUS</label>
                        <div class="input-wrapper">
                            <i class="fas fa-check-circle"></i>
                            <select id="bu_status">
                                <option value="" selected disabled>-- PILIH STATUS --</option>
                                <option value="PESERTA LPS">PESERTA LPS</option>
                                <option value="PESERTA DLHK">PESERTA DLHK</option>
                                <option value="TIDAK IKUT LPS">TIDAK IKUT LPS</option>
                            </select>
                        </div>
                    </div>

                    <!-- TARIF IURAN -->
                    <div class="input-group">
                        <label><i class="fas fa-money-bill-wave"></i> TARIF IURAN (Rp)</label>
                        <div class="input-wrapper">
                            <i class="fas fa-hand-holding-usd"></i>
                            <input type="number" id="bu_tarif" placeholder="CONTOH: 50000" min="0" step="1000">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tombol Submit -->
        <div class="submit-section">
            <button class="btn-submit" id="submitAllBtn">
                <i class="fas fa-cloud-upload-alt"></i>
                KIRIM DATA
            </button>
        </div>

        <div class="footer">
            <p>© 2025 Lembaga Pengelola Sampah Padang Terubuk</p>
        </div>
    </div>

    <!-- Modal Sukses -->
    <div class="modal-overlay" id="successModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-check"></i>
            </div>
            <h3>BERHASIL!</h3>
            <p>Data peserta berhasil disimpan ke DATABASE LPS Padang Terubuk.</p>
            <div class="modal-actions">
                <button class="modal-btn btn-primary" id="lanjutBtn">ISI LAGI</button>
                <button class="modal-btn btn-secondary" id="keluarBtn">KELUAR</button>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Notifikasi -->
    <div class="notification" id="notification">
        <i class="fas fa-info-circle"></i>
        <span id="notificationMessage"></span>
    </div>

    <script>
    // GANTI DENGAN URL APPS SCRIPT ANDA - PASTIKAN SUDAH DEPLOY VERSI BARU
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyXFRgBbhJ2oSYsrlJn3oxsL9lKzqu1Tn6MawLj1jm497mp3XcNs-3ETisib1GsjDB7/exec';

    // Set default tanggal untuk semua form
    document.querySelectorAll('.tanggal-input').forEach(input => {
        input.valueAsDate = new Date();
    });

    // Fungsi uppercase untuk semua input text
    document.querySelectorAll('.uppercase-input').forEach(input => {
        input.addEventListener('input', function() {
            this.value = this.value.toUpperCase();
        });
    });

    // Fungsi format input hanya angka
    function hanyaAngka(input) {
        input.value = input.value.replace(/[^0-9]/g, '');
    }

    // Filter angka untuk semua input
    document.querySelectorAll('.nik-input, .kk-input, .telp-input, .rt-input, .rw-input').forEach(input => {
        input.addEventListener('input', function() {
            // Hanya angka
            this.value = this.value.replace(/[^0-9]/g, '');
            
            // Batasi panjang
            if (this.classList.contains('nik-input') || this.classList.contains('kk-input')) {
                if (this.value.length > 16) this.value = this.value.slice(0, 16);
            } else if (this.classList.contains('rt-input') || this.classList.contains('rw-input')) {
                if (this.value.length > 3) this.value = this.value.slice(0, 3);
            } else if (this.classList.contains('telp-input')) {
                if (this.value.length > 15) this.value = this.value.slice(0, 15);
            }
        });
    });

    // Fungsi format RT/RW (tambahan untuk memastikan 3 digit)
    window.formatRT_RW = function(input) {
        // Hanya angka
        input.value = input.value.replace(/[^0-9]/g, '');
        
        // Batasi 3 digit
        if (input.value.length > 3) {
            input.value = input.value.slice(0, 3);
        }
    };

    // Element global
    const modal = document.getElementById('successModal');
    const loading = document.getElementById('loadingOverlay');
    const notification = document.getElementById('notification');
    const notificationMessage = document.getElementById('notificationMessage');

    // Fungsi switch tab
    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        document.getElementById(tabId).classList.add('active');
        
        const tabButtons = document.querySelectorAll('.tab-btn');
        if (tabId === 'rumah-tangga') tabButtons[0].classList.add('active');
        else if (tabId === 'umkm') tabButtons[1].classList.add('active');
        else if (tabId === 'badan-usaha') tabButtons[2].classList.add('active');
    }

    // Fungsi notifikasi
    function showNotification(message, isError = false) {
        notificationMessage.textContent = message;
        notification.style.borderLeftColor = isError ? '#dc3545' : '#2e7d32';
        notification.querySelector('i').style.color = isError ? '#dc3545' : '#2e7d32';
        notification.classList.add('show');
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    // Fungsi reset form
    function resetActiveForm() {
        const activeTab = document.querySelector('.tab-content.active').id;
        
        if (activeTab === 'rumah-tangga') {
            document.getElementById('rt_tanggal').valueAsDate = new Date();
            document.getElementById('rt_nama').value = '';
            document.getElementById('rt_nik').value = '';
            document.getElementById('rt_kk').value = '';
            document.getElementById('rt_alamat').value = '';
            document.getElementById('rt_rt').value = '';
            document.getElementById('rt_rw').value = '';
            document.getElementById('rt_kelurahan').value = 'PADANG TERUBUK';
            document.getElementById('rt_kecamatan').value = 'SENAPELAN';
            document.getElementById('rt_kota').value = 'PEKANBARU';
            document.getElementById('rt_provinsi').value = 'RIAU';
            document.getElementById('rt_telp').value = '';
            document.getElementById('rt_status').value = '';
            document.getElementById('rt_tarif').value = '';
        } 
        else if (activeTab === 'umkm') {
            document.getElementById('umkm_tanggal').valueAsDate = new Date();
            document.getElementById('umkm_nama').value = '';
            document.getElementById('umkm_nama_usaha').value = '';
            document.getElementById('umkm_no_izin').value = '';
            document.getElementById('umkm_nik').value = '';
            document.getElementById('umkm_kk').value = '';
            document.getElementById('umkm_alamat').value = '';
            document.getElementById('umkm_rt').value = '';
            document.getElementById('umkm_rw').value = '';
            document.getElementById('umkm_kelurahan').value = 'PADANG TERUBUK';
            document.getElementById('umkm_kecamatan').value = 'SENAPELAN';
            document.getElementById('umkm_kota').value = 'PEKANBARU';
            document.getElementById('umkm_provinsi').value = 'RIAU';
            document.getElementById('umkm_telp').value = '';
            document.getElementById('umkm_status').value = '';
            document.getElementById('umkm_tarif').value = '';
        }
        else if (activeTab === 'badan-usaha') {
            document.getElementById('bu_tanggal').valueAsDate = new Date();
            document.getElementById('bu_nama').value = '';
            document.getElementById('bu_nama_usaha').value = '';
            document.getElementById('bu_no_izin').value = '';
            document.getElementById('bu_nik').value = '';
            document.getElementById('bu_kk').value = '';
            document.getElementById('bu_alamat').value = '';
            document.getElementById('bu_rt').value = '';
            document.getElementById('bu_rw').value = '';
            document.getElementById('bu_kelurahan').value = 'PADANG TERUBUK';
            document.getElementById('bu_kecamatan').value = 'SENAPELAN';
            document.getElementById('bu_kota').value = 'PEKANBARU';
            document.getElementById('bu_provinsi').value = 'RIAU';
            document.getElementById('bu_telp').value = '';
            document.getElementById('bu_status').value = '';
            document.getElementById('bu_tarif').value = '';
        }
        
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }

    // Fungsi ambil data dari form aktif (TANPA NAMA_PETUGAS)
    function getActiveFormData() {
        const activeTab = document.querySelector('.tab-content.active').id;
        
        if (activeTab === 'rumah-tangga') {
            return {
                sheetName: 'RUMAH_TANGGA',
                TANGGAL_INPUT: document.getElementById('rt_tanggal').value || '',
                NAMA_PESERTA: document.getElementById('rt_nama').value.toUpperCase() || '',
                NO_NIK: document.getElementById('rt_nik').value || '',
                NO_KK: document.getElementById('rt_kk').value || '',
                ALAMAT: document.getElementById('rt_alamat').value.toUpperCase() || '',
                RT: document.getElementById('rt_rt').value || '',
                RW: document.getElementById('rt_rw').value || '',
                KELURAHAN: document.getElementById('rt_kelurahan').value.toUpperCase() || 'PADANG TERUBUK',
                KECAMATAN: document.getElementById('rt_kecamatan').value.toUpperCase() || 'SENAPELAN',
                KOTA: document.getElementById('rt_kota').value.toUpperCase() || 'PEKANBARU',
                PROVINSI: document.getElementById('rt_provinsi').value.toUpperCase() || 'RIAU',
                NO_TELP: document.getElementById('rt_telp').value || '',
                STATUS: document.getElementById('rt_status').value || '',
                TARIF_IURAN: document.getElementById('rt_tarif').value || '0'
                // NAMA_PETUGAS dihapus
            };
        } 
        else if (activeTab === 'umkm') {
            return {
                sheetName: 'UMKM',
                TANGGAL_INPUT: document.getElementById('umkm_tanggal').value || '',
                NAMA_PESERTA: document.getElementById('umkm_nama').value.toUpperCase() || '',
                NAMA_UMKM: document.getElementById('umkm_nama_usaha').value.toUpperCase() || '',
                NO_SURAT_IZIN_USAHA_UMKM: document.getElementById('umkm_no_izin').value.toUpperCase() || '',
                NO_NIK: document.getElementById('umkm_nik').value || '',
                NO_KK: document.getElementById('umkm_kk').value || '',
                ALAMAT: document.getElementById('umkm_alamat').value.toUpperCase() || '',
                RT: document.getElementById('umkm_rt').value || '',
                RW: document.getElementById('umkm_rw').value || '',
                KELURAHAN: document.getElementById('umkm_kelurahan').value.toUpperCase() || 'PADANG TERUBUK',
                KECAMATAN: document.getElementById('umkm_kecamatan').value.toUpperCase() || 'SENAPELAN',
                KOTA: document.getElementById('umkm_kota').value.toUpperCase() || 'PEKANBARU',
                PROVINSI: document.getElementById('umkm_provinsi').value.toUpperCase() || 'RIAU',
                NO_TELP: document.getElementById('umkm_telp').value || '',
                STATUS: document.getElementById('umkm_status').value || '',
                TARIF_IURAN: document.getElementById('umkm_tarif').value || '0'
                // NAMA_PETUGAS dihapus
            };
        }
        else if (activeTab === 'badan-usaha') {
            return {
                sheetName: 'BADAN_USAHA',
                TANGGAL_INPUT: document.getElementById('bu_tanggal').value || '',
                NAMA_PESERTA: document.getElementById('bu_nama').value.toUpperCase() || '',
                NAMA_BADAN_USAHA: document.getElementById('bu_nama_usaha').value.toUpperCase() || '',
                NO_SURAT_IZIN_BADAN_USAHA: document.getElementById('bu_no_izin').value.toUpperCase() || '',
                NO_NIK: document.getElementById('bu_nik').value || '',
                NO_KK: document.getElementById('bu_kk').value || '',
                ALAMAT: document.getElementById('bu_alamat').value.toUpperCase() || '',
                RT: document.getElementById('bu_rt').value || '',
                RW: document.getElementById('bu_rw').value || '',
                KELURAHAN: document.getElementById('bu_kelurahan').value.toUpperCase() || 'PADANG TERUBUK',
                KECAMATAN: document.getElementById('bu_kecamatan').value.toUpperCase() || 'SENAPELAN',
                KOTA: document.getElementById('bu_kota').value.toUpperCase() || 'PEKANBARU',
                PROVINSI: document.getElementById('bu_provinsi').value.toUpperCase() || 'RIAU',
                NO_TELP: document.getElementById('bu_telp').value || '',
                STATUS: document.getElementById('bu_status').value || '',
                TARIF_IURAN: document.getElementById('bu_tarif').value || '0'
                // NAMA_PETUGAS dihapus
            };
        }
    }

    // Handle submit button
    document.getElementById('submitAllBtn').addEventListener('click', async () => {
        // Validasi sederhana
        const activeTab = document.querySelector('.tab-content.active').id;
        let isValid = true;
        let errorMessage = '';
        
        if (activeTab === 'rumah-tangga') {
            if (!document.getElementById('rt_nama').value) {
                isValid = false;
                errorMessage = 'Nama peserta harus diisi!';
            }
        } else if (activeTab === 'umkm') {
            if (!document.getElementById('umkm_nama').value) {
                isValid = false;
                errorMessage = 'Nama pemilik harus diisi!';
            }
        } else {
            if (!document.getElementById('bu_nama').value) {
                isValid = false;
                errorMessage = 'Nama penanggung jawab harus diisi!';
            }
        }
        
        if (!isValid) {
            showNotification(errorMessage, true);
            return;
        }
        
        // Tampilkan loading
        loading.classList.add('active');

        // Ambil data dari form aktif
        const formData = getActiveFormData();
        
        console.log('Mengirim data:', formData);

        try {
            // Kirim ke Apps Script
            const response = await fetch(APPS_SCRIPT_URL, {
                method: 'POST',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams(formData).toString()
            });

            // Sembunyikan loading
            loading.classList.remove('active');

            // Tampilkan modal sukses
            modal.classList.add('active');

        } catch (error) {
            loading.classList.remove('active');
            
            // Tetap anggap berhasil untuk user experience
            modal.classList.add('active');
            
            console.error('Error detail:', error);
        }
    });

    // Tombol "Isi Lagi"
    document.getElementById('lanjutBtn').addEventListener('click', () => {
        modal.classList.remove('active');
        resetActiveForm();
    });

    // Tombol "Keluar"
    document.getElementById('keluarBtn').addEventListener('click', () => {
        window.location.href = 'https://lpspadangterubukasri.github.io/Home';
    });

    // Expose function ke global
    window.switchTab = switchTab;
</script>
</body>
</html>